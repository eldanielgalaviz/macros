<div class="navbar text-bg-dark text-white w-100 px-4 py-3">
    <div class="container-fluid">
      <div class="row w-100 align-items-center">
        <div class="col d-flex align-items-center">
          <a (click)="goBack()" class="text-white me-3" style="cursor: pointer;">
            <i class="fas fa-arrow-left fa-lg"></i>
          </a>
        </div>
        <div class="col text-center">
          <span class="navbar-brand mb-0 h1 text-white">Registro de Comidas</span>
        </div>
        <div class="col d-flex justify-content-end">
          <span class="h5 mb-0 text-white">{{ patientInfo?.nombre }} {{ patientInfo?.apellidopaterno }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="container mt-5">
    <!-- Selector de fecha -->
    <div class="card mb-4">
      <div class="card-body">
        <div class="row align-items-center">
          <div class="col text-start">
            <button class="btn btn-link" (click)="prevDay()">
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>
          <div class="col text-center">
            <h5 class="mb-0">{{ selectedDate | dateEs }}</h5>
          </div>
          <div class="col text-end">
            <button class="btn btn-link" (click)="nextDay()">
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Resumen de Macronutrientes -->
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Macronutrientes Totales del Día</h5>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <strong>Proteínas:</strong>
            <span>{{ macroTotals.proteinas_totales }}g</span>
          </div>
          <div class="progress">
            <div class="progress-bar bg-success" 
                 [style.width.%]="getPercentage(macroTotals.proteinas_totales, getTotalMacros())">
            </div>
          </div>
        </div>
        <div class="mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <strong>Carbohidratos:</strong>
            <span>{{ macroTotals.carbohidratos_totales }}g</span>
          </div>
          <div class="progress">
            <div class="progress-bar bg-info" 
                 [style.width.%]="getPercentage(macroTotals.carbohidratos_totales, getTotalMacros())">
            </div>
          </div>
        </div>
        <div class="mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <strong>Grasas:</strong>
            <span>{{ macroTotals.grasas_totales }}g</span>
          </div>
          <div class="progress">
            <div class="progress-bar bg-warning" 
                 [style.width.%]="getPercentage(macroTotals.grasas_totales, getTotalMacros())">
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-between align-items-center">
          <strong>Calorías Totales:</strong>
          <span>{{ macroTotals.calorias_totales }} kcal</span>
        </div>
      </div>
    </div>

    <!-- Lista de Comidas -->
    <div *ngFor="let comida of comidas" class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">{{ comida.nombre }}</h5>
      </div>
      <div class="card-body">
        <div *ngIf="comida.alimentos.length > 0">
          <div *ngFor="let alimento of comida.alimentos" class="mb-3 p-3 border rounded">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <h6 class="mb-1">{{ alimento.nombre }}</h6>
                <div class="text-muted small">Cantidad: {{ alimento.cantidad }}</div>
                <div class="mt-2">
                  <span class="me-3">P: {{ alimento.proteinas }}g</span>
                  <span class="me-3">C: {{ alimento.carbohidratos }}g</span>
                  <span class="me-3">G: {{ alimento.grasas }}g</span>
                  <span>Cal: {{ alimento.calorias }} kcal</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="comida.alimentos.length === 0" class="text-center text-muted">
          No hay alimentos registrados
        </div>
      </div>
    </div>
  </div>